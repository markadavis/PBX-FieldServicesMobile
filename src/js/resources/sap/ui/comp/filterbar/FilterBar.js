/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/core/library','sap/m/VBox','sap/m/Bar','sap/m/Button','sap/m/CheckBox','sap/m/Label','sap/m/Link','sap/m/List','sap/m/Panel','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','sap/ui/comp/state/UIState','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/InvisibleText','sap/ui/core/Icon','sap/ui/core/Title','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/VerticalLayout','sap/ui/layout/AlignedFlowLayout','sap/ui/comp/util/IdentifierUtil','sap/m/library','sap/ui/model/json/JSONModel','sap/ui/comp/filterbar/FilterGroupItem','sap/base/Log','sap/base/util/merge','sap/ui/base/ManagedObject','sap/ui/core/ShortcutHintsMixin'],function(c,V,B,a,C,L,b,d,P,S,T,e,f,D,U,g,h,l,k,m,o,I,p,q,G,r,s,H,t,A,u,v,J,F,w,x,M,y){"use strict";var z=c.ValueState;var E=c.TextAlign;var K=v.ListSeparators;var N=v.ButtonType;var O;var Q;var R;var W;var X;var Y;var Z;var $;var _;var a1;var b1=v.OverflowToolbarPriority;var c1=v.ListMode;var d1=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"},isRunningInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogCancel:{},filtersDialogSearch:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:r.render});d1.INTERNAL_GROUP="__$INTERNAL$";d1.prototype.init=function(){var i=this.getFilterContainerWidth();G.prototype.init.apply(this,arguments);this._filterGroupItemChange=this._filterGroupItemChange.bind(this);this._filterItemChange=this._filterItemChange.bind(this,null);this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oShowAllFiltersButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oDialog=null;this._oFilterDialog=null;this._bIsInitialized=false;this._oInitializedDeferred=new l1();this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._nMaxFiltersByDefault=9999;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar sapUiCompFilterBarMarginBottom sapUiCompFilterBarPaddingPanel sapContrastPlus");this.addStyleClass(this._isPhone()?"sapUiCompFilterBarPhone":"sapUiCompFilterBarNonPhone");this._oToolbar=this._createToolbar();this.addContent(this._oToolbar);this._bDelayRendering=true;this._bShowAllFilters=false;this._oBasicAreaLayout=new A();this._oBasicAreaLayout.setVisible(false);this._oBasicAreaLayout.setLayoutData(new s({span:"L12 M12 S12"}));this._oBasicAreaLayout.setMinItemWidth(i);this._oBasicAreaLayout.setMaxItemWidth(i);this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new s({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this.addContent(this._oAdvancedPanel);this.oModel=new J({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:E.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};d1.prototype.onBeforeRendering=function(){if(G.prototype.onBeforeRendering){G.prototype.onBeforeRendering.apply(this,arguments);}if(this.getIsRunningInValueHelpDialog()){if(this._oShowAllFiltersButton===null){this.initShowAllFiltersButton();}if(this._oBasicSearchField&&this._oBasicSearchField.isA("sap.m.SearchField")){this._oBasicSearchField.setWidth("50%");this._oBasicSearchField.setShowMagnifier(true);this._oBasicSearchField.setShowSearchButton(true);}this._oBasicAreaLayout.setMaxItemWidth(null);this._oAdvancedPanel.setVisible(false);this._rerenderFilters();}else if(this._oShowAllFiltersButton){this._oBasicAreaLayout.removeEndContent(this._oShowAllFiltersButton);this._oShowAllFiltersButton=null;}};d1.prototype.getShowAllFiltersButton=function(){return this._oShowAllFiltersButton;};d1.prototype.setFilterContainerWidth=function(i){this._oBasicAreaLayout.setMinItemWidth(i);if(this.getUseToolbar()){this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());}else{this._setMaxItemWidth2();}this.setProperty("filterContainerWidth",i);return this;};d1.prototype._setMaxItemWidth2=function(){var j,n,m1=this._oBasicAreaLayout.getMinItemWidth();["rem","%","px","em"].some(function(n1){var i=m1.indexOf(n1);if(i>0){m1=m1.substring(0,i);j=n1;return true;}return false;});if(j){n=parseInt(m1);if(!isNaN(n)){n*=2;this._oBasicAreaLayout.setMaxItemWidth(n+j);}}};d1.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};d1.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(this._isNewFilterBarDesign()){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j){i=this._oAdvancedPanel.indexOfContent(this._oHintText);if(i<0){this._oAdvancedPanel.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);this._oAdvancedPanel.setVisible(j);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!j&&this.getFilterBarExpanded());}}};d1.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var m1=this._mAdvancedAreaFilter[n];if(m1&&m1.items){for(i=0;i<m1.items.length;i++){j=m1.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};d1.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);var j=true;if(this._isPhone()&&this.getUseToolbar()){j=false;}if(i&&this.getFilterBarExpanded()&&j&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};d1.prototype.getVariantManagement=function(){return this._oVariantManagement;};d1.prototype.setShowClearOnFB=function(i){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);return this;};d1.prototype.setShowRestoreOnFB=function(i){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);return this;};d1.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();return this;};d1.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){i=false;}this._oSearchButton.setVisible(i);};d1.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);return this;};d1.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};d1.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};d1.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};d1.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton){this._oFiltersButton.setVisible(i);}return this;};d1.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};d1.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};d1.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};d1.prototype.getDataSuiteFormat=function(i){return this._getDataSuiteFormat(i,null);};d1.prototype._getDataSuiteFormat=function(i,j){var n=null,m1,n1,o1,p1,q1;if(this._oVariantManagement){m1=this.getCurrentVariantId();if(this.getFilterDataAsString){o1=this._determineVariantFiltersInfo(i,true);if(this.getFilterContextUrl){q1=this.getFilterContextUrl();}if(this.getParameterContextUrl){p1=this.getParameterContextUrl();}n1=this.getFilterDataAsString(i);if(n1){var r1=new h();n=r1.convert(m1,o1,n1,this,j,p1,q1);}}}return n;};d1.prototype.getBasicSearchName=function(){var i=null;if(this._oBasicSearchField&&this.getEntitySet){i="$"+this.getEntitySet()+".basicSearch";}return i;};d1.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue();};d1.prototype.setUiStateAsVariant=function(i){var j={replace:true,strictMode:true};this.setUiState(i,j);this.fireAfterVariantLoad("SPV_VARIANT",false);this._applyVisibility(i.getSelectionVariant());};d1.prototype._applyVisibility=function(i){var j=function(m1){if(m1&&m1.getVisible()&&!m1.getHiddenFilter()){if(!m1.getVisibleInFilterBar()){m1.setVisibleInFilterBar(true);}if(!m1.getPartOfCurrentVariant()){m1.setPartOfCurrentVariant(true);}}};if(this._bIsInitialized){for(var n in this._mAdvancedAreaFilter){if(n){this._mAdvancedAreaFilter[n].items.forEach(function(m1){if(m1&&m1.filterItem&&m1.filterItem.getMandatory()){j(m1.filterItem);}else if(m1&&m1.filterItem){if(m1.filterItem.getVisibleInFilterBar()){m1.filterItem.setVisibleInFilterBar(false);}if(m1.filterItem.getPartOfCurrentVariant()){if(n===d1.INTERNAL_GROUP){m1.filterItem.setPartOfCurrentVariant(true);}else{m1.filterItem.setPartOfCurrentVariant(false);}}}});}}if(i&&i.Parameters){i.Parameters.forEach(function(m1){var n1=this.determineFilterItemByName(m1.PropertyName);j(n1);}.bind(this));}if(i&&i.SelectOptions){i.SelectOptions.forEach(function(m1){var n1=this.determineFilterItemByName(m1.PropertyName);j(n1);}.bind(this));}}};d1.prototype.getUiState=function(i){var j,n,m1=false,n1=null,o1,p1;if(i){m1=(i.allFilters===true);}n=this._getDataSuiteFormat(m1,"13.0");j=new U();j.selectionVariant=JSON.parse(n);j.setSelectionVariant(j.selectionVariant);var q1=j.getSelectionVariant();if(q1){if(this.getModelData&&this.getModelData()){n1=this.getModelData();}p1=U.calcSemanticDates(q1,n1);j.setSemanticDates(p1);o1=U.calculateValueTexts(q1,n1);j.setValueTexts(o1);window.sessionStorage.setItem(this.getId(),JSON.stringify(o1));window.sessionStorage.setItem("semanticDates",JSON.stringify(p1));}return j;};d1.prototype.setUiState=function(i,j){var n,m1,n1=null,o1=false,p1=true,q1;if(j&&typeof j.replace==="boolean"){o1=j.replace;}if(j&&typeof j.strictMode==="boolean"){p1=j.strictMode;}if(i){n1=i.getSelectionVariant();if(n1){m1=JSON.stringify(n1);}n=i.getValueTexts();q1=i.getSemanticDates();}if(!n){n=JSON.parse(window.sessionStorage.getItem(this.getId()));}if(!q1){q1=JSON.parse(window.sessionStorage.getItem("semanticDates"));}this._setDataSuiteFormat(m1,o1,p1,n,q1);this._enhanceFilterItemsWithTextValue(n,n1);};d1.prototype.getDescriptionForKeys=function(i){};d1.prototype._enhanceFilterItemsWithTextValue=function(i,j){var n=U.determineFiltersWithOnlyKeyValues(i,j,[this.getBasicSearchName()]);this.getDescriptionForKeys(n);};d1.prototype.setDataSuiteFormat=function(i,j){this._setDataSuiteFormat(i,j,true);};d1.prototype._setDataSuiteFormat=function(i,j,n,m1,n1){var o1,p1,q1;if(i){o1=new g();p1=o1.convert(i,this,n);if(p1){this._clearErrorState();if(p1.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(p1.variantId,"DATA_SUITE");}else{this._setFilterVisibility(p1.variantId);}}this._oVariantManagement.setInitialSelectionKey(p1.variantId);}if(p1.payload&&(j||(Object.keys(JSON.parse(p1.payload)).length>0))&&this.setFilterDataAsString){q1=p1.payload;if(m1){q1=U.enrichWithValueTexts(q1,m1);}if(n1){q1=U.enrichWithSemanticDates(q1,n1);}this.setFilterDataAsString(q1,j);}if(p1.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||p1.basicSearch);this._updateToolbarText();}}}};d1.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.hasOwnProperty("version")){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};d1.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var n=j.customData[i];if(n&&n.mProperties&&n.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(n.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}this._applyLayoutDataToToolbarButtons();G.prototype.applySettings.apply(this,arguments);if(!this.getUseToolbar()&&!this.getFilterBarExpanded()){this.setFilterBarExpanded(true);}this._afterVariantsLoad();};d1.prototype._applyLayoutDataToToolbarButtons=function(i){if(this._isPhone()||this._isTablet()||this.getAdvancedMode()||!this.getUseToolbar()){return;}if(!O&&!this._bToolbarLayoutDataRequested){O=sap.ui.require("sap/m/ToolbarLayoutData");if(!O){sap.ui.require(["sap/m/ToolbarLayoutData"],e1.bind(this));this._bToolbarLayoutDataRequested=true;}}if(!O){return;}this._oHideShowButton.setLayoutData(new O({shrinkable:true}));this._oClearButtonOnFB.setLayoutData(new O({shrinkable:true}));this._oRestoreButtonOnFB.setLayoutData(new O({shrinkable:true}));this._oFiltersButton.setLayoutData(new O({shrinkable:true}));this._oSearchButton.setLayoutData(new O({shrinkable:false}));};function e1(i){O=i;this._bToolbarLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._applyLayoutDataToToolbarButtons();}}d1.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}return this;};d1.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};d1.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};d1.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}return this;};d1.prototype.setSearchButtonEmphType=function(i){};d1.prototype.setSimplifiedMode=function(i){};d1.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};d1.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);return this;};d1.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};d1.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(!this._oAdvancedAreaForm){this._oAdvancedAreaForm=this._createAdvancedAreaForm();}if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));}}}if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());}this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this;};d1.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}else{this._recreateToolbar();}return this;};d1.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null;}this._oToolbar=this._createToolbar(true);this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof m||((this._oVariantManagement.getId()===(this.getId()+"-variant")))){this._oToolbar.insertContent(this._oVariantManagement,0);}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField);}this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:E.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());this._updateToolbarText();}};d1.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var j=this._oBasicSearchFieldContainer.removeAllContent();if(j){for(var i=0;i<j.length;i++){if(j[i]!==this._oBasicSearchField){j[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}};d1.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}return this;};d1.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(i){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){if(!Q&&!this._bToolbarSeparatorRequested){Q=sap.ui.require("sap/m/ToolbarSeparator");if(!Q){sap.ui.require(["sap/m/ToolbarSeparator"],f1.bind(this));this._bToolbarSeparatorRequested=true;}}if(Q){this._oSeparator=new Q(this.getId()+"-HeadSep");}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem");}if(!this._oText){this._oText=new T(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight();}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText;}}}};function f1(i){Q=i;this._bToolbarSeparatorRequested=false;if(!this._bIsBeingDestroyed){this._addHeaderToToolbar(this.getHeader());}}d1.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};d1.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(true&&this.getFilterBarExpanded());}if(this._oToolbar){var j=this._oToolbar.getContent();for(var i=0;i<j.length;i++){this._oToolbar.removeContent(j[i]);if(j[i].isA("sap.m.ToolbarSpacer")){j[i].destroy();}}if(!this.getUseToolbar()){this.removeContent(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField);}this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._setMaxItemWidth2();}};d1.prototype._addButtonsToBasicArea=function(){var i=new t();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();i.addContent(new T());i.addContent(j);j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._oFiltersButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oSearchButton);this._updateToolbarText();this._oBasicAreaLayout.addEndContent(i);this._oButtonsVLayout=i;};d1.prototype._addBasicSearchToBasicArea=function(i){if(this._oBasicSearchFieldContainer){this._cleanBasicSearchContainer();}if(i){var j=new L({text:"\u2008"});j.addStyleClass("sapBasicSearchFilter");var n=this._addControlToBasicAreaContainer(null,i,j);if(n){n.setVisible(true);this._oBasicAreaLayout.insertContent(n,0);this._oBasicSearchFieldContainer=n;this._oBasicSearchFieldContainer.setWidth("100%");}}};d1.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};d1.prototype.setBasicSearch=function(i){var j=this;this.setAssociation("basicSearch",i,true);if(typeof i==="string"){i=sap.ui.getCore().byId(i);}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(m1){j.fireFilterChange(m1);});}}}this._oBasicSearchField=i;return this;};d1.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue();}return null;};d1.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof f){return i;}}}return 0;};d1.prototype.addFilterItem=function(i){var n,j,m1,n1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var o1={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(o1);n1=i.getId()+"__filterGroupItem";m1=sap.ui.getCore().byId(n1);if(!m1){m1=new F(i.getId()+"__filterGroupItem",{label:i.getLabel(),controlTooltip:i.getControlTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:d1.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter(),entitySetName:i.getEntitySetName(),entityTypeName:i.getEntityTypeName()});}if(i.data('isCustomField')){m1.data('isCustomField',true);}i.attachChange(this._filterItemChange);this.addFilterGroupItem(m1);return this;};d1.prototype.addFilterGroupItem=function(i){var n,j,m1,n1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}m1={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(m1);if(!i.getHiddenFilter()){n1=this._addControlToBasicAreaFormContainer(i);if(n1){m1.container=n1;n1.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange);}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();return this;};d1.prototype.removeFilterItem=function(j){var i,n,m1,n1,o1=this.getFilterItems(),p1=this.getFilterGroupItems();if(!o1||!o1.length){return null;}n=this._getRemovedItemAsObject(j,o1);if(!n){return null;}n.detachChange(this._filterItemChange);for(i=0;i<this._aBasicAreaSelection.length;i++){if(this._aBasicAreaSelection[i].filterItem.getId()===n.getId()){this._aBasicAreaSelection.splice(i,1);if(this._aBasicAreaSelection.length===0){this._aBasicAreaSelection=null;}break;}}this.removeAggregation("filterItems",n,true);m1=n.getId()+"__filterGroupItem";n1=this._getRemovedItemAsObject(m1,p1);this._removeFilterGroupItem(n1);return n;};d1.prototype.removeFilterGroupItem=function(i){var j,n=this.getFilterGroupItems();if(!n||!n.length){return null;}j=this._getRemovedItemAsObject(i,n);if(!j){return null;}return this._removeFilterGroupItem(j);};d1.prototype._getRemovedItemAsObject=function(j,n){var i,m1;if(typeof j==="string"){for(i=0;i<n.length;i++){if(n[i].getId()===j){m1=n[i];break;}}}if(typeof j==="number"){if(j<0||j>=n.length){w.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItems() is called with invalid index "+j);}else{m1=n[j];}}if(typeof j==="object"){m1=j;}return m1;};d1.prototype._removeFilterGroupItem=function(j){var i,n,m1,n1=j.getGroupName();j.detachChange(this._filterGroupItemChange);this.removeAggregation("filterGroupItems",j,true);if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[n1]&&this._mAdvancedAreaFilter[n1].items){n=this._mAdvancedAreaFilter[n1];for(i=0;i<n.items.length;i++){m1=n.items[i];if(m1.filterItem.getId()===j.getId()){m1.container.removeAllContent();m1.container.destroy();n.items.splice(i,1);if(n.filterItem.getId()===j.getId()){if(n.items.length){n.filterItem=n.items[0].filterItem;}else{delete this._mAdvancedAreaFilter[n1];}}break;}}if(this.getFilterGroupItems().length===0){this._mAdvancedAreaFilter=null;this._adaptButtonsEnablement();}}return j;};d1.prototype._addParameter=function(j){var i,n,m1,n1=false,o1=false,p1=d1.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);n={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[p1]){this._mAdvancedAreaFilter[p1]={};this._mAdvancedAreaFilter[p1].filterItem=null;}if(!this._mAdvancedAreaFilter[p1].items){this._mAdvancedAreaFilter[p1].items=[];}for(i=0;i<this._mAdvancedAreaFilter[p1].items.length;i++){var q1=this._mAdvancedAreaFilter[p1].items[i];if(q1.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[p1].items.splice(i,0,n);n1=true;break;}if(!n1){this._mAdvancedAreaFilter[p1].items.push(n);if(Object.keys(this._mAdvancedAreaFilter).length>1){o1=true;}}m1=this._addControlToBasicAreaFormContainer(j);if(m1){n.container=m1;m1.setVisible(j.getVisible());j.attachChange(this._filterGroupItemChange.bind(this));}if(n1||o1){this._oBasicAreaLayout.removeContent(m1);if(j.getVisible()){this._addContainerInOrder(n.filterItem,n.container);}}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();return this;};d1.prototype._filterItemChange=function(i,j){var n,m1,n1,o1;if(j&&j.oSource&&(j.oSource.isA("sap.ui.comp.filterbar.FilterItem"))){n1=j.getParameter("propertyName");if(n1==="visibleInFilterBar"||n1==="visible"||n1==="label"||n1==="labelTooltip"||n1==="controlTooltip"||n1==="mandatory"){n=this._determineItemByName(j.oSource.getName(),d1.INTERNAL_GROUP);if(n&&n.filterItem){if((n1==="visible")){m1=j.oSource.getVisible();n.filterItem.setVisible(m1);}else if(n1==="visibleInFilterBar"){m1=j.oSource.getVisibleInFilterBar();var p1=this._checkChangePossibleVisibleInFilterBar(n.filterItem,m1);if(p1){n.filterItem.setVisibleInFilterBar(m1);}else{j.oSource.setVisibleInFilterBar(true);}}else if(n1==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(n1==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(n1==="controlTooltip"){o1=this.determineControlByFilterItem(n.filterItem,true);if(o1&&o1.setTooltip){o1.setTooltip(n.filterItem.getControlTooltip());}}else if(n1==="mandatory"){m1=j.oSource.getMandatory();n.filterItem.setMandatory(m1);}}}}};d1.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var m1=i.oSource.getVisibleInFilterBar();var n1=m1;var o1=this._checkChangePossibleVisibleInFilterBar(i.oSource,m1);if(!o1){i.oSource.setVisibleInFilterBar(true);n1=true;}if(n1){i.oSource.setPartOfCurrentVariant(true);}var p1=this._isFilterItemInBasicGroup(j.filterItem);if(!m1&&!p1){i.oSource.setPartOfCurrentVariant(false);}if(!this.getAdvancedMode()&&!this._oDialog&&!this._oAdaptFiltersDialog){if(this._bOldAdaptFilterDialog&&!p1||!this._bOldAdaptFilterDialog){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}}else if(n==="visible"){if(!this._oAdaptFiltersDialog){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){this._mandatoryFilterItemChange(i.oSource);}else if((n==="partOfCurrentVariant")&&this.ensureLoadedValueHelpList){var q1=this.determineFilterItemByName(i.oSource.getName());if(q1&&q1.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(i.oSource.getName());}}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA();}}};d1.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};d1.prototype._removeContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)>-1)){this._oBasicAreaLayout.removeContent(i.container);}}}};d1.prototype._addContainerInOrder=function(j,m1){var n,i,n1,o1=this._oBasicAreaLayout.getContent(),p1=-1;if(this._isNewFilterBarDesign()){if(this._isPhone()){p1++;}if(this._oBasicSearchField){p1++;}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var q1=this._mAdvancedAreaFilter[n];if(q1&&q1.items){for(i=0;i<q1.items.length;i++){if(!q1.items[i].container){continue;}if(q1.items[i].container===m1){this._oBasicAreaLayout.insertContent(m1,p1+1);return;}n1=o1.indexOf(q1.items[i].container);if(n1>=0){p1=n1;}}}}}};d1.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};d1.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};d1.prototype._hasFilterValue=function(i){var j;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){j=this.getAllFiltersWithValues();}else{j=this._getFiltersWithValues();}return this._checkFilterForValue(j,i);};d1.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var m1=true;if(i.getMandatory()){var n1=this._hasFilterValue(i);if(!n1){m1=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(m1);}}};d1.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i&&!i.getHiddenFilter()){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};d1.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};d1.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==d1.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};d1.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;return this;};d1.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;return this;};d1.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;return this;};d1.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};d1.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}if(this.getIsRunningInValueHelpDialog()){this._rerenderFilters();}};d1.prototype.variantsInitialized=function(){this._afterVariantsLoad();this.fireInitialized();this._oInitializedDeferred.resolve();};d1.prototype.fireInitialized=function(){this.fireEvent("initialized");this._oInitializedDeferred.resolve();};d1.prototype.getInitializedPromise=function(){return this._oInitializedDeferred.promise;};d1.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};d1.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");this._showHintText();}catch(i){w.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};d1.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};d1.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var n={context:i,executeOnSelect:j};try{this.fireEvent("afterVariantLoad",n);}catch(ex){w.error("error during 'afterVariantLoad' event handling - "+ex.message);}};d1.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};d1.prototype.destroyFilterGroupItems=function(){var i=this.getFilterGroupItems();this._destroyItems(i);return this;};d1.prototype.destroyFilterItems=function(){var i=this.getFilterItems();this._destroyItems(i);return this;};d1.prototype.removeAllFilterItems=function(){var i,j=this.getFilterItems();if(j&&j.length){for(i=0;i<j.length;i++){this.removeFilterItem(j[i]);}}return j;};d1.prototype.removeAllFilterGroupItems=function(){var i,j=[],n=this.getFilterGroupItems();if(n&&n.length){for(i=0;i<n.length;i++){j.push(n[i]);this.removeFilterGroupItem(n[i]);}}return j;};d1.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};d1.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};d1.prototype.getAllFilterItems=function(j){var i,n=null;var m1=[];var n1,o1;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){n1=this._mAdvancedAreaFilter[n];if(n1.items){for(i=0;i<n1.items.length;i++){o1=n1.items[i];if(o1&&o1.filterItem&&o1.filterItem.getVisible()){if(j){if(o1.filterItem.getVisibleInFilterBar()||this._checkIfFilterHasValue(o1.filterItem.getName())){m1.push(o1.filterItem);}}else{m1.push(o1.filterItem);}}}}}}}return m1;};d1.prototype._checkIfFilterHasValue=function(i){return false;};d1.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState();};d1.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};d1.prototype._getFilterInformation=function(){return[];};d1.prototype._createVisibleFilters=function(){this._getFilters();};d1.prototype._getFilters=function(){var j=[],n=this._oFilterProvider&&this._oFilterProvider.getModel()&&this._oFilterProvider.getModel().getData();if(n){j=Object.keys(n).filter(function(n1){return this._checkIfFilterHasValue(n1);}.bind(this));}this._aFields=this._getFilterInformation();var i,m1;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[d1.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[d1.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[d1.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){m1=this._aFields[i];if(m1.groupName!==d1.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[m1.groupName]){this._mAdvancedAreaFilter[m1.groupName]={};this._mAdvancedAreaFilter[m1.groupName].groupTitle=m1.groupTitle;this._mAdvancedAreaFilter[m1.groupName].filterItem=null;this._mAdvancedAreaFilter[m1.groupName].items=[];}}if(m1.visibleInAdvancedArea||(m1.groupName===d1.INTERNAL_GROUP)||j.indexOf(m1.name)!==-1){this._instanciateFilterItem(m1);}}}this._adaptButtonsEnablement();};d1.prototype.isVisibleInFilterBarByName=function(n){var i,j=this._getFilterMetadata(n);if(j&&j.factory){if((j.hasOwnProperty("visibleInAdvancedArea")&&j.visibleInAdvancedArea)||(j.groupName===d1.INTERNAL_GROUP)){return true;}}else{i=this.determineFilterItemByName(n);if(i){return i.getVisibleInFilterBar();}}return false;};d1.prototype._getFilterMetadata=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i];}}}return null;};d1.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames();}else{return this._getNonVisibleCustomFilterNames();}};d1.prototype._getLazyNonVisibleCustomFilterNames=function(){var i=this,j=[];this._aFields.forEach(function(n){if(n.factory){if(n.isCustomFilterField&&!n.visibleInAdvancedArea){j.push(n.fieldName);}}else if(i._isNonVisibleCustomFilterNamesByName(n.fieldName,n.groupName)){j.push(n.fieldName);}});return j;};d1.prototype._isNonVisibleCustomFilterNamesByName=function(n,j){var i,m1;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){m1=this._mAdvancedAreaFilter[j].items[i];if(m1.filterName&&(m1.filterItem.getName()===n)){return this._isNonVisibleCustomFilterNamesByFilter(m1.filterItem);}}}return false;};d1.prototype._isNonVisibleCustomFilterNamesByFilter=function(i){if(i.data("isCustomField")&&!i.getVisibleInFilterBar()){return true;}return false;};d1.prototype._getNonVisibleCustomFilterNames=function(){var i=this,j=[],n=this.getAllFilterItems();if(n){n.forEach(function(m1){if(i._isNonVisibleCustomFilterNamesByFilter(m1)){j.push(m1.getName());}});}return j;};d1.prototype._ensureFilterLoaded=function(n){var i,j,m1;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){m1=this._aFields[j];if(!m1.factory){continue;}if(n){for(i=0;i<n.length;i++){if(m1.fieldName===n[i].name){if(m1.groupName===n[i].group){this._instanciateFilterItem(m1);break;}else if(m1.groupEntityType===n[i].group){this._instanciateFilterItem(m1);}}}}else{this._instanciateFilterItem(m1);}}if(!n){this._aFields=[];}}};d1.prototype._instanciateFilterItem=function(i){var j=i.factory;if(j){delete i.factory;j.call(i);}};d1.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};d1.prototype._reapplyVisibility=function(j){var i,n=null;var m1;var n1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var o1=this._mAdvancedAreaFilter[n];if(o1&&o1.items){for(i=0;i<o1.items.length;i++){m1=o1.items[i];if(m1&&m1.filterItem){this._setPersVisibility(j,m1.filterItem,n1);}}if(n!==d1.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}return n1;};d1.prototype._setPersVisibility=function(i,j,n){var m1,n1;if(j&&!j.getHiddenFilter()){m1=j.getGroupName();n1=this._checkForFilterInfo(i,j);if(this._isTINAFScenario()){if(n1){j.setVisibleInFilterBar(n1.visibleInFilterBar);if(n1.hasOwnProperty("visible")){j.setVisible(n1.visible);}}else{j.setVisibleInFilterBar(false);if((m1===d1.INTERNAL_GROUP)||j._isParameter()){}}}else{if(n1&&(n1.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((n1.visibleInFilterBar));}else{if((m1!==d1.INTERNAL_GROUP)&&n1&&(n1.group===m1)){j.setVisibleInFilterBar((n1!==null));}}}if(j){var o1=this.determineControlByFilterItem(j,true);if(o1&&o1.getValueState&&(o1.getValueState()!==z.None)){o1.setValueState(z.None);}if(n1&&n1.hasOwnProperty("partOfCurrentVariant")&&(!n1.partOfCurrentVariant)){n.push(j);}}}};d1.prototype._checkForFilterInfo=function(n,m1){var i,j,n1=m1.getName(),o1=[m1.getGroupName(),m1.getEntitySetName(),m1.getEntityTypeName()];var p1=[];if(n&&n.length){for(i=0;i<n.length;i++){if(n[i].name===n1){if(o1.indexOf(n[i].group)>-1){p1.push(n[i]);}}}}if(p1.length===1){return p1[0];}else if(p1.length>1){for(j=0;j<o1.length;j++){for(i=0;i<p1.length;i++){if(p1[i].group===o1[j]){return p1[i];}}}}return null;};d1.prototype._createVariantManagement=function(){var i=new m(this.getId()+"-variantUi2",{});var j=new k({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};d1.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};d1.prototype.retrieveFiltersWithValuesAsText=function(){var j,n,m1=this.retrieveFiltersWithValues(),n1,o1=this.getBasicSearchValue();if(o1&&m1){m1.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"));}if(!m1||(m1.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){n1=Math.min(5,m1.length);n="";for(var i=0;i<n1;i++){n+=m1[i];if(i<(n1-1)){n+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[m1.length,n]);if(n1<m1.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[m1.length]);}}return j;};d1.prototype.retrieveFiltersWithValues=function(){var i,j=[];var n=this._getFiltersWithValues();if(n){for(i=0;i<n.length;i++){if(n[i].getHiddenFilter()){continue;}if(n[i].getVisible()&&n[i].getPartOfCurrentVariant()){j.push(n[i].getLabel());}}}return j;};d1.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){w.error("callback for obtaining the filter count throws an exception");}}return null;};d1.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};d1.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};d1.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof f){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};d1.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());this._bShowAllFilters=false;this._rerenderFilters();};d1.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var j=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var m1=n?(this._oRb.getText(i,[n])):(this._oRb.getText(j));this._oFiltersButton.setText(m1);this.fireAssignedFiltersChanged();};d1.prototype.setFilterBarExpanded=function(i){var j;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));}}this._calcVisibilityGoButton();if(this.getIsRunningInValueHelpDialog()){this._oBasicAreaLayout.setVisible(i);}else{this._oAdvancedPanel.setVisible(i);}}else{if(this._isPhone()&&this.getUseToolbar()){j=false;}else{j=i;}this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return this;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();return this;};d1.prototype._selectionChangedInFilterDialog=function(i,j){this._selectionChangedInFilterDialogByValue(i.getSelected(),j);};d1.prototype._selectionChangedInFilterDialogByValue=function(j,m1){m1.setVisibleInFilterBar(j);if(this._mAdvancedAreaFilter&&this._bOldAdaptFilterDialog){for(var n in this._mAdvancedAreaFilter){if(n){var n1=this._mAdvancedAreaFilter[n];if(n1&&n1.items){for(var i=0;i<n1.items.length;i++){var o1=n1.items[i];if(m1===o1.filterItem){if(o1.hasOwnProperty("selectedAsPoCV")){o1.selectedAsPoCV=j;}break;}}}}}}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};d1.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n){this._mandatoryFilterItemChange(n.filterItem);}};d1.prototype._mandatoryFilterItemChange=function(i){if(i){if(!i.getMandatory()){return;}var j=this._hasFilterValue(i);if(!i.getVisibleInFilterBar()&&!j){i.setVisibleInFilterBar(true);}}};d1.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();this._retrieveVisibleAdvancedItems();this._setConsiderFilterChanges(true);return i;};d1.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,m1;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){m1=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!m1.getVisible()||m1.getHiddenFilter()){continue;}if(!this._checkIfFilterHasValue(m1.getName())&&!m1.getVisibleInFilterBar()){n++;}}}return n;};d1.prototype._rerenderGroup=function(j,n){var i;var m1;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){m1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(m1&&m1.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};d1.prototype._setLinkTextAndCount=function(i,j,n){var m1;if(n){m1=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{m1=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(m1);};d1.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};d1.prototype._createLink=function(i,j){var n,m1=this;n=u.replace(i);var n1=new b(this.getId()+"-link-"+n);this._setLinkText(i,n1);n1.attachPress(function(){m1._createAddRemoveFiltersDialog(i,n1);});return n1;};d1.prototype._isPhone=function(){return!!(D.system.phone);};d1.prototype._isTablet=function(){return!!(D.system.tablet&&!D.system.desktop);};d1.prototype._createForm=function(i){var j=this;var n=new Y(this.getId()+"-form",{editable:true,layout:i});n.contentOnAfterRendering=function(m1,n1){Y.prototype.contentOnAfterRendering.apply(this,arguments);if(n1.isA("sap.m.MultiInput")){j._adaptStyleSheet(n1);}};return n;};d1.prototype._adaptStyleSheet=function(i){var j;var n;if(i.isA("sap.m.MultiInput")){n=i.$();if(n){j=n.parent().css("overflow");if(j!=="visible"){n.parent().css({"overflow":"visible"});}}}};d1.prototype._addFieldToFiltersDialog=function(i,j,n){var m1,n1,o1,p1;if(!i&&!i.filterItem||i.filterItem.getHiddenFilter()){return;}var q1=this._isFilterItemInBasicGroup(i.filterItem)||this._determineVisibility(i.filterItem);if(i.control.getWidth){i.width=i.control.getWidth();if(i.control.setWidth){i.control.setWidth("100%");}}m1=i.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){m1.setText(i.filterItem.getLabel());}n1=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});n1.setSelected(i.filterItem.getVisibleInFilterBar());if(i.filterItem.getMandatory()){p1=this._checkFilterForValue(n,i.filterItem);if(!p1&&i.filterItem.getVisibleInFilterBar()){n1.setEnabled(false);}}n1.attachSelect(this._selectionChangedInFilterDialog.bind(this,n1,i.filterItem));if(this._isNewFilterBarDesign()||!this._isPhone()){i.control.setLayoutData(new s({span:"L8 M8 S11"}));n1.setLayoutData(new s({span:"L1 M1 S1"}));}else{i.control.setLayoutData(new s({span:"L8 M8 S12"}));n1.setVisible(false);}o1=new $({label:m1,fields:[i.control,n1]});o1.setVisible(q1);i.formelement=o1;i.checkbox=n1;j.addFormElement(o1);};d1.prototype._createHeaderAddToFilterBar=function(i){var j;if(this._isNewFilterBarDesign()||!this._isPhone()){j=new L(this.getId()+"-addToFilterBar",{text:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});var n=new a1({text:M.escapeSettingsValue(i.getTitle().getText()),level:c.TitleLevel.H5,titleStyle:c.TitleLevel.H5});var m1=new e(this.getId()+"-addToFilterBarToolbar",{content:[n,new f(),j]});i.setToolbar(m1);i.addAriaLabelledBy(n);j.setLabelFor(null);}};d1.prototype._addBasicSearchAddToFilterBar=function(i){var j;if(!this._isPhone()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();if(this._oToolbar){this._replaceOnToolbar(this._oBasicSearchField,this._oBasicSearchFieldClone);}else{this._addBasicSearchToBasicArea(this._oBasicSearchFieldClone);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isNewFilterBarDesign()||!this._isPhone()){this._oBasicSearchField.setLayoutData(new s({span:"L8 M8 S11",indent:"L3 M3 S0"}));}else{this._oBasicSearchField.setLayoutData(new s({span:"L8 M8 S12"}));}if(this._isPhone()&&this.getAdvancedMode()){j=new $({fields:[this._oBasicSearchFieldClone]});}else{j=new $({fields:[this._oBasicSearchField]});}i.addFormElement(j);};d1.prototype._isGroupEmpty=function(i){var j=true;i.some(function(n){if(n.filterItem&&n.filterItem.getVisible()&&!n.filterItem.getHiddenFilter()){j=false;return true;}return false;});return j;};d1.prototype._createFilters=function(){var j=this,n=null,i,m1;var n1=null,o1,p1,q1;var r1,s1,t1=true,u1;this._oClonedVM=null;var v1=new _();v1.setColumnsL(1);v1.setLabelSpanL(3);v1.setColumnsM(1);v1.setLabelSpanM(3);var w1=this._createForm(v1);w1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._possibleToChangeVariantManagement()&&this._oToolbar){var x1=this._oToolbar.indexOfContent(this._oVariantManagement);if(x1>=0){var y1=o.prototype._setSelection;o.prototype._setSelection=function(){};this._oClonedVM=this._oVariantManagement.clone();o.prototype._setSelection=y1;this._oClonedVM._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._replaceOnToolbar(this._oVariantManagement,this._oClonedVM);n1=new Z();this._oVariantManagement.setLayoutData(new s({span:"L10 M10 S12"}));o1=new $({fields:this._oVariantManagement});n1.addFormElement(o1);w1.addFormContainer(n1);}w1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField&&!this._isNewFilterBarDesign()){if(!n1){n1=new Z();w1.addFormContainer(n1);}this._addBasicSearchAddToFilterBar(n1);}this._ensureFilterLoaded(null);var z1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(A1){j._mandatoryFilterChange(A1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};x(this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===d1.INTERNAL_GROUP){m1=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{m1=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}s1=new q({text:M.escapeSettingsValue(m1)});n1=new Z({title:M.escapeSettingsValue(s1)});if(t1&&!this._isGroupEmpty(this._mAdvancedAreaFilter[n].items)){t1=false;this._createHeaderAddToFilterBar(n1);if(this._oBasicSearchField&&this._isNewFilterBarDesign()){this._addBasicSearchAddToFilterBar(n1);}}u1=0;this._mAdvancedAreaFilter[n].formcontainer=n1;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){q1=this._mAdvancedAreaFilter[n].items[i];this._addFieldToFiltersDialog(q1,n1,z1);if(!q1.filterItem.getVisible()){u1++;}}p1=n1.getFormElements();if(p1&&p1.length>0){if((n!==d1.INTERNAL_GROUP)&&!this.getAdvancedMode()){r1=this._createLink(n,s1);if(r1){if(this._isPhone()){r1.setLayoutData(new s({span:"L8 M8 S12"}));}else{r1.setLayoutData(new s({span:"L8 M8 S12",indent:"L3 M3 S0"}));}o1=new $({fields:[r1]});this._mAdvancedAreaFilter[n].link=r1;n1.addFormElement(o1);}if(u1===p1.length){n1.setVisible(false);}}w1.addFormContainer(n1);}}}return w1;};d1.prototype._replaceOnToolbar=function(i,n){var j;if(this._oToolbar){j=this._oToolbar.indexOfContent(i);if(j>-1){this._oToolbar.insertContent(n,j);this._oToolbar.removeContent(i);}}};d1.prototype._recreateBasicAreaContainer=function(j){var n=null,i;var m1,n1;var o1,p1,q1;if(this._possibleToChangeVariantManagement()&&this._oToolbar&&this._oClonedVM&&this._oVariantManagement){this._replaceOnToolbar(this._oClonedVM,this._oVariantManagement);this._oClonedVM.destroy();this._oClonedVM=null;}if(!this._isPhone()&&this._oToolbar&&this._oBasicSearchFieldClone&&this._oBasicSearchField){this._replaceOnToolbar(this._oBasicSearchFieldClone,this._oBasicSearchField);this._oBasicSearchFieldClone.destroy();this._oBasicSearchFieldClone=null;}var r1=this._oBasicAreaLayout.removeAllContent();if(!j){if(r1){var s1=r1.length;var t1=0;if(this._isNewFilterBarDesign()){if(this._isPhone()){t1++;}else{s1--;}}for(i=t1;i<s1;i++){if(r1[i]!==this._oHintText){r1[i].destroy();}}}}if(this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(this._oBasicSearchField);this._addButtonsToBasicArea();}for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){o1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(o1.getHiddenFilter()){continue;}q1=null;if(j){if(!o1.getVisible()||!o1.getVisibleInFilterBar()){continue;}p1=this._mAdvancedAreaFilter[n].items[i].container;if(p1){if(p1.$()&&p1.$().width()){q1=p1.$().width();}p1.removeAllContent();p1.destroy();}m1=this._mAdvancedAreaFilter[n].items[i].control.clone();n1=o1.getLabelControl(this.getId()).clone();n1.setLabelFor(null);if(this.getConsiderGroupTitle()){o1.getLabelControl(this.getId()).setText(o1.getLabel());}}else{m1=this._mAdvancedAreaFilter[n].items[i].control;n1=o1.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){m1.setWidth("100%");}}p1=this._addControlToBasicAreaContainer(o1,m1,n1);if(p1){p1.setVisible(o1.getVisible()&&o1.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=p1;if(j&&q1){p1.setWidth("100%");}}}}}};d1.prototype._focusOnFirstFilterInError=function(){for(var n in this._mAdvancedAreaFilter){if(this._mAdvancedAreaFilter[n].items){for(var i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.control&&j.control.getValueState&&j.control.getValueState()==="Error"){this._expandGroup(j);j.control.getDomRef().scrollIntoView();return;}}}}};d1.prototype._searchRequested=function(i){var j,n=false;if(this.verifySearchAllowed){j=this.verifySearchAllowed();if(j.hasOwnProperty("pending")){return;}else if(j.hasOwnProperty("error")||j.hasOwnProperty("mandatory")){n=true;}}if(n){this._bOKFiltersDialogTriggered=false;if(this._oFiltersSearchField&&this._oFiltersSearchField.getValue()){this._resetFilterBarSearch();}this._activateMainContent();this._focusOnFirstFilterInError();}else{this._bOKFiltersDialogTriggered=true;if(!this.isLiveMode||!this.isLiveMode()){this.search();}else{i.close();}}};d1.prototype._activateMainContent=function(){var i=this.getFilterDialogContent();if(i&&(i.length>1)){this.addFilterDialogContent(i[0]);}};d1.prototype.fireSearch=function(i){if(this._bOKFiltersDialogTriggered){if(this._oFilterDialog){this._oFilterDialog.close();}else if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.close();}}this.fireEvent("search",i);};d1.prototype._closeDialogAndRestoreFilterBar=function(){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};if(this._oFilterDialogForm){this._oFilterDialogForm.removeAllFormContainers();}this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}this._updateToolbarText();};d1.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};d1.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};d1.prototype._variantSavePressed=function(i){this._bVariantSavePressed=true;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};d1.prototype._filterSetInErrorState=function(i){if(this._oFilterDialog&&this._oFilterDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;}};d1.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===false)){this.fireCancel();return;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this._resetFiltersInErrorValueState();var j=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(j);this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};d1.prototype._resetFiltersInErrorValueState=function(){var n;n=this._retrieveCurrentSelectionSet(true,true);n.forEach(function(i){if(i.control&&i.control.setValueState&&i.control.getValueState){if(i.control.getValueState()===z.Error){if(i.control.setValue){i.control.setValue("");}i.control.setValueState(z.None);}}});};d1.prototype.showFilterDialog=function(){if(!this._oFilterDialog){this._showFilterDialog();}};d1.prototype.addFilterDialogContent=function(i){if(this._oFilterDialog&&i){var n=this._oFilterDialog.indexOfContent(i);if(n<0){this._oFilterDialog.addContent(i);}return this._setFilterDialogActiveContent(i);}return null;};d1.prototype.getFilterDialogContent=function(){if(this._oFilterDialog){return this._oFilterDialog.getContent();}return null;};d1.prototype._setFilterDialogActiveContent=function(n){var i=false;if(this._oFilterDialog){this.getFilterDialogContent().forEach(function(j){if(n===j){j.setVisible(true);i=true;}else{j.setVisible(false);}});if(i){return n;}}return null;};d1.prototype._getFilterDialogActiveContent=function(){var i=null;if(this._oFilterDialog){this.getFilterDialogContent().some(function(j){if(j.getVisible()){i=j;return true;}return false;});}return i;};d1.prototype.setContentWidth=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentWidth(n+"px");}if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentWidth(n+"px");}};d1.prototype.addAdaptFilterDialogCustomContent=function(i,j,n){this._mCustomViewInfo={item:i,search:j,content:n};};d1.prototype.setContentHeight=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentHeight(n+"px");}if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentHeight(n+"px");}};d1.prototype._createStructureForAdaptFiltersDialog=function(){var j,m1,n1={filtersOnFilterBar:{items:[]},allFilters:[]};var o1,p1=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){j=this._mAdvancedAreaFilter[n];if(j.items){for(var i=0;i<j.items.length;i++){m1=j.items[i];if(!m1.filterItem){continue;}if(m1.filterItem.getHiddenFilter()){continue;}o1=this._checkFilterForValue(p1,m1.filterItem);if(m1.filterItem.getVisibleInFilterBar()){n1.filtersOnFilterBar.items.push({name:m1.filterItem.getName()});}var q1=m1.filterItem.getGroupName()?m1.filterItem.getGroupName():d1.INTERNAL_GROUP;var r1=(q1===d1.INTERNAL_GROUP)?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):m1.filterItem.getGroupTitle();var s1=m1.filterItem.getControlTooltip()?m1.filterItem.getControlTooltip():"";n1.allFilters.push({name:m1.filterItem.getName(),label:m1.filterItem.getLabel(),group:q1,groupLabel:r1,tooltip:s1,visibleInDialog:m1.filterItem.getVisible(),filterItem:m1.filterItem,isFiltered:o1});}}}}}return n1;};d1.prototype._restoreControls=function(j){var m1,n1,o1;if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){m1=this._mAdvancedAreaFilter[n];if(m1.items){for(var i=0;i<m1.items.length;i++){n1=m1.items[i];if(n1.checkbox){delete n1.checkbox;}if(n1.filterItem&&!n1.filterItem.getHiddenFilter()&&n1.control&&n1.container){if(n1.fnDestroy){n1.control.destroy=n1.fnDestroy;delete n1.fnDestroy;o1=n1.container.getContent();n1.container.removeContent(o1[1]);o1[1].destroy();n1.container.insertContent(n1.control,1);n1.filterItem.detachChange(j);}}}}}}}this._rerenderFilters();};d1.prototype._expandGroup=function(n){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialogModel&&this._oGroupPanel&&n&&n.filterItem){var m1=n.filterItem.getGroupName()?n.filterItem.getGroupName():d1.INTERNAL_GROUP;var n1=this._oAdaptFiltersDialogModel.getData().itemsGrouped;for(var i=0;i<n1.length;i++){if(n1[i].group===m1){for(var j=0;j<n1[i].items.length;j++){if(n1[i].items[j].name===n.filterItem.getName()){this._oGroupPanel.setGroupExpanded(n1[i].items[j].group,true);return;}}return;}}}};var g1,h1;d1.prototype._getEntitiesLazy=function(){if(g1&&h1&X){return Promise.resolve();}this.setBusy(true);return sap.ui.getCore().loadLibrary('sap.ui.mdc',{async:true}).then(function(){return new Promise(function(i){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder","sap/ui/mdc/p13n/panels/GroupPanelBase","sap/m/CustomListItem"],function(j,n,m1){g1=j;h1=n;X=m1;i();this.setBusy(false);}.bind(this));}.bind(this));}.bind(this));};d1.prototype.setShowOldFilterDialog=function(){this._bOldAdaptFilterDialog=true;};d1.prototype._filtersButtonPressed=function(){this._oFiltersButton.focus();if(this._bOldAdaptFilterDialog){this._showFilterDialog();}else{this._showAdaptFilterDialog();}};d1.prototype._checkAssignedFilters=function(){if(this._oAdaptFiltersDialog){var j=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();var n=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<n.length;i++){if(n[i].hasOwnProperty("filterItem")){var m1=this._checkFilterForValue(j,n[i].filterItem);if(n[i].isFiltered!==m1){n[i].isFiltered=m1;}}}}};d1.prototype._showAdaptFilterDialog=function(){return new Promise(function(n){this._getEntitiesLazy().then(function(){if(!this._oAdaptFiltersDialog){var m1=function(y1,z1){for(var i=0;i<y1.length;i++){if(y1[i].group===z1){var q1=y1[i].items;for(var j=0;j<q1.length;j++){if(q1[j].filterItem&&q1[j].filterItem.getVisible()){if(!y1[i].groupVisible){y1[i].groupVisible=true;}return;}}if(y1[i].groupVisible){y1[i].groupVisible=false;}return;}}};var n1=function(j){if(j&&j.oSource&&(j.oSource.isA("sap.ui.comp.filterbar.FilterItem"))){var y1=j.getParameter("propertyName");if(this._oAdaptFiltersDialogModel&&y1){var q1=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<q1.length;i++){if(q1[i].hasOwnProperty("filterItem")&&q1[i].filterItem===j.oSource){if(y1==="visible"){var z1=j.oSource.getVisible();if(q1[i].visibleInDialog!=z1){q1[i].visibleInDialog=z1;m1(this._oAdaptFiltersDialogModel.getData().itemsGrouped,q1[i].group);this._oAdaptFiltersDialogModel.checkUpdate();break;}}else if(y1==="visibleInFilterBar"){q1[i].selected=j.oSource.getVisibleInFilterBar();this._oAdaptFiltersDialogModel.checkUpdate();break;}}}}}}.bind(this);this._ensureFilterLoaded(null);var o1=this._createStructureForAdaptFiltersDialog();var p1=g1.prepareP13nData(o1.filtersOnFilterBar,o1.allFilters);this._oAdaptFiltersDialogModel=new J();this._oAdaptFiltersDialogModel.setSizeLimit(1000);this._oAdaptFiltersDialogModel.setData(p1);var q1=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<q1.length;i++){if(q1[i].hasOwnProperty("filterItem")){q1[i].filterItem.attachChange(n1);}}this._fRegisteredFilterChangeHandlers=function(j){this._mandatoryFilterChange(j);}.bind(this);this.attachFilterChange(this._fRegisteredFilterChangeHandlers);var r1=function(j){var y1=j.getParameter("reason")==="Add";var z1=j.getParameter("item");if(!z1){return;}if(z1.name==="_BASIC_SEARCH_FIELD"){z1.selected=true;return;}var A1=this._determineItemByName(z1.name,z1.group);if(A1&&A1.filterItem){if(A1.filterItem.getMandatory()&&!y1&&!this._hasFilterValue(A1.filterItem)){z1.selected=true;}else{this._selectionChangedInFilterDialogByValue(z1.selected,A1.filterItem);}}}.bind(this);var s1=new h1({change:r1,expandFirstGroup:true,enableReorder:false,enableListView:false});this._oGroupPanel=s1;var t1="$p13n";s1.setItemFactory(function(j,y1){var z1,A1,B1,C1;C1=y1.getObject();if(!C1){return undefined;}B1=this._determineItemByName(C1.name,C1.group);if(!B1||!B1.filterItem||!B1.control){return undefined;}z1=B1.filterItem;A1=B1.control;if(!A1){return undefined;}var D1=u.replace(C1.group+"-"+z1.getName()+"-selectFiltersItem");if(B1.container&&B1.container.getContent()[1]===A1){B1.container.removeContent(B1.control);B1.container.insertContent(B1.control.clone(),1);if(B1.control.destroy){B1.fnDestroy=B1.control.destroy;B1.control.destroy=function(){};}}var E1=new L({text:"{"+t1+">label}"});E1.setLabelFor(A1);if(z1&&z1.getMandatory()){E1.setRequired(true);}var F1=new X(D1,{selected:"{"+t1+">selected}",visible:"{"+t1+">visibleInDialog}",content:[E1,A1]});return F1;}.bind(this));this.fireFiltersDialogBeforeOpen({newDialog:true});s1.setP13nModel(this._oAdaptFiltersDialogModel);if(this._mCustomViewInfo&&this._mCustomViewInfo.item&&this._mCustomViewInfo.item.getKey()){s1.addCustomView(this._mCustomViewInfo);var u1=false;if(this._validateMandatoryFields){u1=!this._validateMandatoryFields();}s1.switchViewMode(u1?s1.GROUP_KEY:this._mCustomViewInfo.item.getKey());}var v1=function(j){this._dialogCancel(this._oAdaptFiltersDialog);}.bind(this);var w1=function(j){this._bOKFiltersDialogTriggered=true;this._oAdaptFiltersDialog.close();}.bind(this);var x1;if(this.getShowRestoreButton()){x1={onExecute:this._dialogRestore.bind(this),idButton:this.getId()+"-resetBtn"};}g1.createP13nDialog(s1,{id:this.getId()+"-adapt-filters-dialog",title:this._oRb.getText(this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_DIALOG":"FILTER_BAR_ADV_FILTERS_DIALOG"),reset:x1,verticalScrolling:false,cancel:v1,confirm:{text:this._oRb.getText("FILTER_BAR_OK"),handler:w1}}).then(function(j){this._oAdaptFiltersDialog=j;this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};x(this._oInitialVariant,this._oVariant);this._bOKFiltersDialogTriggered=false;this._oAdaptFiltersDialog.attachBeforeOpen(function(){this._bDirtyViaDialog=false;}.bind(this));this._oAdaptFiltersDialog.attachBeforeClose(function(){this._restoreControls(n1);if(!this._bOKFiltersDialogTriggered){this._cancelFilterDialog(false);}}.bind(this));this._oAdaptFiltersDialog.attachAfterClose(function(){this._oBasicAreaLayout.rerender();this._oAdaptFiltersDialogModel=null;this._oGroupPanel=null;this._oVariant={};this._oInitialVariant=null;this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;if(this._bOKFiltersDialogTriggered&&this._bDirtyViaDialog){if(!this.isLiveMode||!this.isLiveMode()){this.fireFilterChange();}}this.fireFiltersDialogClosed({context:this._bOKFiltersDialogTriggered?"SEARCH":"CANCEL"});}.bind(this));this._oAdaptFiltersDialog.setParent(this);if(this.$().closest(".sapUiSizeCompact").length>0){this._oAdaptFiltersDialog.addStyleClass("sapUiSizeCompact");}this._oAdaptFiltersDialog.isPopupAdaptationAllowed=function(){return false;};this._oAdaptFiltersDialog.open();n();}.bind(this));return;}n();}.bind(this));}.bind(this));};d1.prototype._showFilterDialog=function(){if(!this._bDialogRequested){if((!W||!R||!Y||!Z||!$||!_||!a1)){W=sap.ui.require("sap/m/Dialog");R=sap.ui.require("sap/m/OverflowToolbarLayoutData");Y=sap.ui.require("sap/ui/layout/form/Form");Z=sap.ui.require("sap/ui/layout/form/FormContainer");$=sap.ui.require("sap/ui/layout/form/FormElement");_=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");a1=sap.ui.require("sap/m/Title");if(!W||!R||!Y||!Z||!$||!_||!a1){sap.ui.require(["sap/m/Dialog","sap/m/OverflowToolbarLayoutData","sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout","sap/m/Title"],i1.bind(this));this._bDialogRequested=true;}}}if(!W||!R||!Y||!Z||!$||!_||!a1){return;}if(!this._oFilterDialog){this._oFiltersSearchField=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH"),liveChange:function(i){if(this._oFilterDialog){this.fireFiltersDialogSearchForFilters(i.getParameters());this._triggerSearchInFilterDialog(i);}}.bind(this)});this._oFilterDialog=new W(this.getId()+"-adapt-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true,contentWidth:"60rem",title:this._oRb.getText(this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_DIALOG":"FILTER_BAR_ADV_FILTERS_DIALOG"),verticalScrolling:true,initialFocus:this._oFiltersSearchField,subHeader:new B({contentMiddle:this._oFiltersSearchField}),beforeOpen:function(){this.fireFiltersDialogBeforeOpen();}.bind(this),beforeClose:function(){if(!this._bOKFiltersDialogTriggered){this._cancelFilterDialog(this._bVariantSaveFiltersDialogTriggered);}delete this._oFilterDialog.bDoNotAddToBasicArea;this._closeDialogAndRestoreFilterBar();}.bind(this),afterClose:function(){this._oBasicAreaLayout.rerender();this._oInitialVariant=null;this._oFilterDialog.destroy();this._oFilterDialog=null;this._showHintText();this.fireFiltersDialogClosed({context:this._bOKFiltersDialogTriggered?"SEARCH":"CANCEL"});}.bind(this)}).addStyleClass("sapUiPopupWithPadding sapUiCompFilterBarDialog sapMH4FontSize sapMH4Style");this._oFilterDialog.isPopupAdaptationAllowed=function(){return false;};this._oFilterDialog.setParent(this);if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}}this._oFilterDialogForm=this._createFiltersAndAdaptBasicArea();if(!this._oFilterDialogForm){w.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(this._oFilterDialogForm);this._bOKFiltersDialogTriggered=false;this._bVariantSaveFiltersDialogTriggered=false;this._oFilterDialog.bDoNotAddToBasicArea=true;this._addFilterDialogButtons(this._oFilterDialogForm);this._bDirtyViaDialog=false;this._oFilterDialog.open();};function i1(i,j,n,m1,n1,o1,p1){W=i;R=j;Y=n;Z=m1;$=n1;_=o1;a1=p1;this._bDialogRequested=false;if(!this._bIsBeingDestroyed){this._showFilterDialog();}}d1.prototype.isDialogOpen=function(){return(this._oFilterDialog||this._oAdaptFiltersDialog)?true:false;};d1.prototype._addFilterDialogButtons=function(i){var j=this;var n;var m1=null,n1,o1,p1,q1;p1=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){p1.focus();j._dialogSearch(j._oFilterDialog);},layoutData:new R({priority:b1.NeverOverflow}),type:N.Emphasized});this._oFilterDialog.addButton(p1);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()){this._oVariantManagement._delayedControlCreation();if(this._oVariantManagement.oVariantSave){m1=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._dialogVariantSave(i);},layoutData:new R({priority:b1.Low})});n=this._oVariantManagement.getModel("save_enablement");m1.setModel(n);m1.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(m1);}}n1=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j._dialogClear(i);},layoutData:new R({priority:b1.Low})});this._oFilterDialog.addButton(n1);o1=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j._dialogRestore();},layoutData:new R({priority:b1.Low})});if(n){o1.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());o1.setModel(n);o1.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(o1);q1=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._dialogCancel(j._oFilterDialog);},layoutData:new R({priority:b1.High})});this._oFilterDialog.addButton(q1);}};d1.prototype._adaptMandatoryForVisibleFilters=function(){var j,n=this._retrieveVisibleAdvancedItems();for(var i=0;i<n.length;i++){j=n[i].filterItem;this._adaptMandatoryForFilter(j);}};d1.prototype._dialogSearch=function(i){this.fireFiltersDialogSearch();this._searchRequested(i);};d1.prototype._dialogCancel=function(i){if(i){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();i.close();}};d1.prototype._dialogVariantSave=function(i){this._bVariantSaveFiltersDialogTriggered=true;this._variantSavePressed();};d1.prototype._dialogRestore=function(){this.reset();if(this._oVariantManagement&&this._oVariantManagement.getVisible()&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false);}this._adaptMandatoryForVisibleFilters();this._bDirtyViaDialog=false;};d1.prototype._dialogClear=function(i){this.clear();this._adaptMandatoryForVisibleFilters();};d1.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),tooltip:this._oRb.getText("FILTER_BAR_HIDE"),type:N.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),tooltip:this._oRb.getText("FILTER_BAR_CLEAR"),type:N.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),tooltip:this._oRb.getText("FILTER_BAR_RESTORE"),type:N.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:N.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){this._filtersButtonPressed();}.bind(this));i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:N.Emphasized});y.addConfig(this._oSearchButton,{event:"search"},this);this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};d1.prototype._toggleAllFilters=function(){this._bShowAllFilters=!this._bShowAllFilters;this._oShowAllFiltersButton.setVisible(!this._bShowAllFilters);this._rerenderFilters();};d1.prototype.initShowAllFiltersButton=function(){this._oShowAllFiltersButton=new a({text:this._oRb.getText("FILTER_BAR_VH_SHOW_ALL"),type:N.Transparent,press:this._toggleAllFilters.bind(this)});this._oBasicAreaLayout.addEndContent(this._oShowAllFiltersButton);};d1.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};d1.prototype._createToolbar=function(i){var j=new e(this.getId()+"-toolbar");if(!i){var n=this._createVariantLayout();j.addContent(n);}j.addContent(new f());this._createButtons(j);j.addStyleClass("sapUiCompFilterBarToolbar");j.setLayoutData(new s({span:"L12 M12 S12"}));return j;};d1.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};d1.prototype._createAdvancedAreaForm=function(){if((!Y||!Z||!$||!_)&&!this._bAdvancedRequested){Y=sap.ui.require("sap/ui/layout/form/Form");Z=sap.ui.require("sap/ui/layout/form/FormContainer");$=sap.ui.require("sap/ui/layout/form/FormElement");_=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");if(!Y||!Z||!$||!_){sap.ui.require(["sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout"],j1.bind(this));this._bAdvancedRequested=true;}}if(!Y||!Z||!$||!_){return;}var i=new _(this.getId()+"-AdvancedFormLayout");i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new Y(this.getId()+"-AdvancedForm",{editable:true});j.setLayout(i);if(!this.oInvisibleFormTitle){this.oInvisibleFormTitle=new I({text:this._oRb.getText("ADVANCED_SEARCH_TEXT")});this.addContent(this.oInvisibleFormTitle);}j.addAriaLabelledBy(this.oInvisibleFormTitle);this._oAdvancedPanel.addContent(j);return j;};function j1(i,j,n,m1){Y=i;Z=j;$=n;_=m1;this._bAdvancedRequested=false;if(!this._bIsBeingDestroyed){if(!this.getIsRunningInValueHelpDialog()){this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._rerenderAA();}}}d1.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){w.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){w.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};d1.prototype._addControlToBasicAreaContainer=function(i,j,n){var m1=new t();if(j.setWidth){j.setWidth("100%");}m1.setWidth("100%");if(n){if(!n.hasStyleClass("sapUiCompFilterLabel")){n.addStyleClass("sapUiCompFilterLabel");}m1.addContent(n);if(n.setLabelFor){if(i&&j){n.setLabelFor(j);if(j.setTooltip&&i.getControlTooltip()){j.setTooltip(i.getControlTooltip());}}}}m1.addContent(j);if((!this.getAdvancedMode()||this.getIsRunningInValueHelpDialog())&&(!this._oFilterDialog||(!this._oFilterDialog.hasOwnProperty("bDoNotAddToBasicArea")))){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){var n1=this._oBasicAreaLayout.getContent();if(this._isNewFilterBarDesign()&&!this._isPhone()){this._oBasicAreaLayout.insertContent(m1,n1.length);}else{this._oBasicAreaLayout.addContent(m1);}}}return m1;};d1.prototype._rerenderAA=function(){if(this._oAdvancedAreaForm){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);}};d1.prototype._groupsWithVisibleFilters=function(){var n,j,m1=this._mAdvancedAreaFilter;if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){m1={};for(var n1 in this._mAdvancedAreaFilter){if(n1&&this._mAdvancedAreaFilter[n1]&&this._mAdvancedAreaFilter[n1].items){n=this._mAdvancedAreaFilter[n1].items.length;for(var i=0;i<this._mAdvancedAreaFilter[n1].items.length;i++){j=this._mAdvancedAreaFilter[n1].items[i].filterItem;if(j&&(j.getHiddenFilter()||!j.getVisible())){n--;}}if(n){m1[n1]={};}}}}return m1;};d1.prototype._layOutAA=function(i){var j=this._groupsWithVisibleFilters();if(j&&Object.keys(j).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};d1.prototype._layOutAAMultipleGroup=function(n){var i,j,m1=0,n1=null,o1=false;for(i=0;i<n.length;i++){if(n[i].control===null){m1++;}}if(this._mAdvancedAreaFilter&&(Object.keys(this._mAdvancedAreaFilter).length===2)&&this._mAdvancedAreaFilter[d1.INTERNAL_GROUP]&&this._mAdvancedAreaFilter[d1.INTERNAL_GROUP].items&&(this._mAdvancedAreaFilter[d1.INTERNAL_GROUP].items.length>0)){o1=true;}var p1=this._oAdvancedAreaForm.getLayout();if(p1){if(m1>=3){p1.setLabelSpanL(5);p1.setLabelSpanM(5);p1.setColumnsL(3);p1.setColumnsM(2);}else if(m1===2){p1.setLabelSpanL(4);p1.setLabelSpanM(5);p1.setColumnsL(2);p1.setColumnsM(2);}else if(m1===1){p1.setLabelSpanL(4);p1.setLabelSpanM(5);p1.setColumnsL(2);p1.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){n1=new Z();if((Object.keys(this._mAdvancedAreaFilter).length>1)&&!o1){if((m1>=3)&&(n[i].filterItem.getGroupName()===d1.INTERNAL_GROUP)){n1.setTitle(this._oRb.getText("FILTER_BAR_BASIC_GROUP"));}else{n1.setTitle(n[i].filterItem.getGroupTitle());}}this._oAdvancedAreaForm.addFormContainer(n1);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,n1);j++;}i=j-1;}}if(m1===1){this._oAdvancedAreaForm.addFormContainer(new Z());}};d1.prototype._layOutAASingleGroup=function(j){var i,n,m1,n1;var o1=j.length-1;var p1=o1>2?2:1;if(p1>1){m1=Math.floor(o1/p1);n1=((m1*p1)<o1);for(i=1;i<p1;i++){n=i*m1;if(n1){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};d1.prototype._flattenMap=function(){var n=null,i,j=[],m1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){m1=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var n1=this._mAdvancedAreaFilter[n].items[i];if(n1.filterItem&&n1.filterItem.getVisibleInFilterBar()&&n1.filterItem.getVisible()&&!n1.filterItem.getHiddenFilter()){if(!m1){m1=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:n1.control,filterItem:n1.filterItem});}}}}}return j;};d1.prototype._triggerSearchByValue=function(j){var i,n,m1,n1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){for(i=this._aListItems.length-1;i>=0;i--){n1=this._aListItems[i].getContent();if(n1&&(n1.length>0)){n=n1[0].getText();m1=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(m1&&m1.toLowerCase().indexOf(j)>=0))){this._aListItems[i].setVisible(true);}else{this._aListItems[i].setVisible(false);}}}}};d1.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};d1.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i,m1,n1,o1,p1,q1,r1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){o1=this._mAdvancedAreaFilter[n];if(o1&&o1.items){q1=0;r1=0;for(i=0;i<o1.items.length;i++){if(o1.items[i]&&o1.items[i].filterItem){p1=o1.items[i].filterItem;if(p1.getHiddenFilter()){++q1;continue;}if(p1.getVisible()){if(j&&o1.items[i].formelement){m1=p1.getLabel();n1=p1.getControlTooltip();if((m1.toLowerCase().indexOf(j)>=0)||(n1&&(n1.toLowerCase().indexOf(j)>=0))){if(p1.getPartOfCurrentVariant()){o1.items[i].formelement.setVisible(true);}else{++r1;}}else{++q1;o1.items[i].formelement.setVisible(false);}}else if(o1.items[i].formelement){o1.items[i].formelement.setVisible(p1.getVisibleInFilterBar()||p1.getPartOfCurrentVariant());if(o1.link&&!o1.link.getVisible()){o1.link.setVisible(true);}}}else{++q1;}}}if(o1&&o1.formcontainer){if(q1===o1.items.length){o1.formcontainer.setVisible(false);}else{o1.formcontainer.setVisible(true);if(o1.link){o1.link.setVisible((j&&(r1===0))?false:true);if(j&&(r1>0)){this._setLinkTextAndCount(n,o1.link,r1);}else{this._setLinkText(n,o1.link);}}}}}}}}};d1.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};d1.prototype._generateListItems=function(j,n){if(!X){X=sap.ui.require("sap/m/CustomListItem");if(!X){throw new Error("_generateListItems must only be called via _createAddRemoveFiltersDialog "+this);}}var i;var m1,n1;var o1;var p1=false;if(this.$().closest(".sapUiSizeCompact").length>0){p1=true;}if(j&&this._mAdvancedAreaFilter){n1=this._mAdvancedAreaFilter[j];if(n1&&n1.items){for(i=0;i<n1.items.length;i++){var q1=n1.items[i],r1=u.replace(j+"-"+q1.filterItem.getName()+"-selectFiltersItem");if(q1&&q1.filterItem){if(!q1.filterItem.getVisible()||q1.filterItem.getHiddenFilter()){continue;}m1=new X(r1);m1.setVisible(true);if(!p1){m1.addStyleClass("sapUiCompFilterBarListItem");}else{m1.addStyleClass("sapUiCompFilterBarListItemCompact");}m1.data("quickinfo",q1.filterItem.getControlTooltip()||q1.filterItem.getLabelTooltip());q1.initialPartOfCurrentVariant=this._checkIfFilterHasValue(q1.filterItem.getName());q1.initialVisibleInFilterBar=q1.filterItem.getVisibleInFilterBar();m1.data('item',q1);o1=new L({id:r1+"-label"});o1.setText(q1.filterItem.getLabel());o1.setTooltip(q1.filterItem.getControlTooltip()||q1.filterItem.getLabelTooltip());m1.addContent(o1);n.addItem(m1);if(q1.filterItem.getVisibleInFilterBar()||q1.selectedAsPoCV||this._checkIfFilterHasValue(q1.filterItem.getName())){n.setSelectedItem(m1);}if(q1.filterItem.getMandatory()&&q1.checkbox&&!q1.checkbox.getEnabled()){m1.getModeControl(true).setEnabled(false);}}}}}var s1=this;n.attachSelectionChange(function(t1){if(t1){var u1=t1.getParameter("listItems");if(Array.isArray(u1)){u1.forEach(function(m1){var v1=m1.getModeControl();var q1=m1.data('item');s1._selectionChangedInAddFiltersDialog(v1,q1);});}}});};d1.prototype._rerenderItem=function(i,j){var n;if(i){n=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar()&&!i.filterItem.getHiddenFilter();if(j!==undefined){n=n&&!j;}if(i.container){i.container.setVisible(n);if(!n){this._removeContainer(i);}if(n){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||this._isFilterItemInBasicGroup(i.filterItem)||this._checkIfFilterHasValue(i.filterItem.getName())));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};d1.prototype._rerenderFilters=function(){var i;var n=null;var j=null;var m1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];var n1=j.filterItem.getVisible()&&j.filterItem.getVisibleInFilterBar()&&!j.filterItem.getHiddenFilter();m1.push({visible:n1,item:j});}}}}var o1=this.getIsRunningInValueHelpDialog()&&!this._bShowAllFilters;var p1=m1.filter(function(t1){return t1.visible;}).length;var q1=p1>this._nMaxFiltersByDefault?this._nMaxFiltersByDefault-1:this._nMaxFiltersByDefault;for(var r1=0;r1<m1.length;r1++){var s1=o1&&r1>=q1;this._rerenderItem(m1[r1].item,s1);}if(this._oShowAllFiltersButton){if(o1&&p1>this._nMaxFiltersByDefault){this._oShowAllFiltersButton.setVisible(true);}else{this._oShowAllFiltersButton.setVisible(false);}}this._updateToolbarText();};d1.prototype.rerenderFilters=function(){this._rerenderFilters();};d1.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};d1.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if((n.initialPartOfCurrentVariant!==undefined||n.initialVisibleInFilterBar!==undefined)&&n.filterItem){if(n.filterItem.getHiddenFilter()){continue;}if((n.initialPartOfCurrentVariant!==undefined)&&(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant)){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}if((n.initialVisibleInFilterBar!==undefined)&&(n.filterItem.getVisibleInFilterBar()!==n.initialVisibleInFilterBar)){n.filterItem.setVisibleInFilterBar(n.initialVisibleInFilterBar);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};d1.prototype._sortListItems=function(i,j){var n,m1,n1=i.data('item'),o1=j.data('item');if(n1&&n1.filterItem&&o1&&o1.filterItem){n=n1.filterItem.getLabel();m1=o1.filterItem.getLabel();}return n.localeCompare(m1);};d1.prototype._createAddRemoveFiltersDialog=function(j,n){var i,m1=this;if(!j){return;}if((!W||!X)&&!this._bCustomListItemRequested){X=sap.ui.require("sap/m/CustomListItem");W=sap.ui.require("sap/m/Dialog");if(!W||!X){sap.ui.require(["sap/m/Dialog","sap/m/CustomListItem"],k1.bind(this));this._bCustomListItemRequested=true;this._oFiltersDialogData={groupName:j,link:n};}}if(!W||!X){return;}this._oDialog=new W(this.getId()+"-set-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var n1=new B();var o1=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=o1;o1.attachLiveChange(function(s1){m1._triggerSearch(s1);});n1.addContentMiddle(o1);this._oDialog.setSubHeader(n1);var p1=new d({mode:c1.MultiSelect});p1.setShowSeparators(K.None);this._oDialog.addContent(p1);this._generateListItems(j,p1);this._aListItems=p1.getItems();if(this._aListItems&&this._aListItems.length>1){this._aListItems.sort(this._sortListItems);}for(i=0;i<this._aListItems.length;i++){p1.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var q1=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK"),type:sap.m.ButtonType.Emphasized});q1.attachPress(function(){m1._bOKButtonAddRemoveFilterDialogTriggered=true;m1._oDialog.close();});this._oDialog.addAggregation("buttons",q1);this._oDialog.setInitialFocus(this._oSearchField);if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var r1=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){m1._oDialog.close();}});this._oDialog.addAggregation("buttons",r1);this._oDialog.attachBeforeClose(function(){if(!m1._bOKButtonAddRemoveFilterDialogTriggered){m1._cancelAddRemoveFiltersDialog(j);}m1.rerenderFilters();m1._closeAddRemoveFiltersDialog(j,n);});this._oDialog.attachAfterClose(function(){this._aListItems=null;this._oDialog.destroy();this._oDialog=null;}.bind(this));this._oDialog.open();};function k1(i,j){W=i;X=j;this._bCustomListItemRequested=false;if(!this._bIsBeingDestroyed){this._createAddRemoveFiltersDialog(this._oFiltersDialogData.groupName,this._oFiltersDialogData.link);delete this._oFiltersDialogData;}}d1.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&j.filterItem.getMandatory()&&!j.checkbox.getEnabled()){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);j.filterItem.setVisibleInFilterBar(n);j.selectedAsPoCV=n;this._notifyAboutChangedFilters(n,j.control);};d1.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};d1.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};d1.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};d1.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};d1.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}if(this._oAdaptFiltersDialog&&!(this._oAdaptFiltersDialog.isOpen())){return;}if(this._oAdaptFiltersDialog){this._bDirtyViaDialog=true;this._checkAssignedFilters();}else if(this._oFilterDialog){this._bDirtyViaDialog=true;}this.fireEvent("filterChange",i);};d1.prototype._notifyAboutChangedFilters=function(i,j){var n,m1=this._determineByControl(j);if(i){n={"added":j,"filterItem":m1};}else{n={"deleted":j,"filterItem":m1};}this.fireFilterChange(n);};d1.prototype._determineVariantFiltersInfo=function(j,m1){var i;var n=null,n1,o1;var p1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){n1=this._mAdvancedAreaFilter[n].items[i];if(j||n1.filterItem.getVisible()){o1={group:n1.filterItem.getGroupName(),name:n1.filterItem.getName(),partOfCurrentVariant:n1.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:n1.filterItem.getVisibleInFilterBar(),visible:n1.filterItem.getVisible()};if(m1||this._considerFilter(o1)){p1.push(o1);}}}}}}}return p1;};d1.prototype.mergeVariant=function(i,j){var n={};x(n,j);n.filterbar=[];n.filterBarVariant={};x(n.filterbar,i.filterbar);x(n.filterBarVariant,i.filterBarVariant);if(j&&(j.hasOwnProperty("version"))){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};d1.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(m1){for(i=0;i<j.length;i++){if((j[i].group===m1.group)&&(j[i].name===m1.name)){j.splice(i,1);break;}}});return j.concat(n);};d1.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof m){return true;}return false;};d1.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};d1.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};d1.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var m1=this._getStandardVariant();if(m1&&m1.filterbar){for(var i=0;i<m1.filterbar.length;i++){if((m1.filterbar[i].group===j.group)&&(m1.filterbar[i].name===j.name)){n=m1.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)||(n.visible!==j.visible)){return true;}return false;};d1.prototype._addControlToAdvancedArea=function(i,j,n){var m1=new $({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(m1);};d1.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||this._checkIfFilterHasValue(i.getName()));j=j&&!i.getHiddenFilter();}return j;};d1.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var m1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){m1.push(j);}}}}}}}return m1;};d1.prototype._retrieveCurrentSelectionSet=function(j,n){var i,m1,n1,o1=[];var p1=this._retrieveVisibleAdvancedItems();for(i=0;i<p1.length;i++){m1=p1[i];if(m1.control&&m1.filterItem&&(n||!m1.filterItem._isParameter())){if(j){n1={name:p1[i].filterItem.getName(),control:p1[i].control};}else{n1=p1[i].control;}o1.push(n1);}}return o1;};d1.prototype.search=function(){this.fireSearch({selectionSet:this._retrieveCurrentSelectionSet(false)});return true;};d1.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(i.selectionSet);this._clearErrorState();this.fireClear(i);this._updateToolbarText();};d1.prototype._deleteValidatingTokenFlag=function(i){i.forEach(function(j){if(j.hasOwnProperty("__bValidatingToken")){delete j.__bValidatingToken;}});};d1.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(i);this._resetVariant();};d1.prototype._resetVariant=function(){var i=null,j=null;this._resetFiltersInErrorValueState();var n=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(n);if(this._oVariantManagement){var m1=this._oVariantManagement.getSelectionKey();if(m1){i=this._oVariantManagement.getVariantContent(this,m1);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=i;this._oInitialVariant.modified=false;this._oInitialVariant.key=m1;}}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===undefined)&&this._oInitialVariant&&this._oInitialVariant.content){j=this._oInitialVariant.content;}if(i||j){this.applyVariant(i||j,"RESET");}}}this._resetFilterBarSearch();};d1.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";if(this._oFiltersSearchField){this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}};d1.prototype._removeValuesForNonPartOfCurrentVariants=function(i){};d1.prototype._applyVariant=function(i,j,n,m1){var n1,o1=null,p1,q1=false;if(i){if(n){p1=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);n1=i.filterBarVariant;o1=i.filterbar;this._ensureFilterLoaded(o1);this._applyVariantFields(n1,m1);var r1=this._reapplyVisibility(o1);this._removeValuesForNonPartOfCurrentVariants(r1);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){q1=i.executeOnSelection;}this.fireAfterVariantLoad(j,q1);this._setConsiderFilterChanges(true);this._updateToolbarText();if(q1||(this.getLiveMode&&this.getLiveMode())){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(p1);}}};d1.prototype._fetchVariantFiltersData=function(i){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(i);}catch(j){w.error("callback for fetching data throws an exception");}}else{w.warning("no callback for fetch data supplied");}return null;};d1.prototype._applyVariantFields=function(j,i){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j,i);}catch(n){w.error("callback for applying data throws an exception");}}else{w.warning("no callback for appy data supplied");}};d1.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};d1.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var i=this.getCurrentVariantId();if(!i){return this._oVariantManagement.getExecuteOnSelectForStandardVariant();}var j=this._oVariantManagement.getItemByKey(i);if(j){return j.getExecuteOnSelection();}}return false;};d1.prototype.fetchVariant=function(){var i,j={},n;if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V3";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData(j.version);n=this._getBasicSearchValue();if(n){j.basicSearch=n;}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};d1.prototype.applyVariant=function(i,j,n){if(i.hasOwnProperty("version")){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n,i.version);};d1.prototype._afterVariantsLoad=function(){if(this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded());}this._bDelayRendering=false;};d1.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};d1.prototype.determineControlByFilterItem=function(j,m1){var i,n=null;var n1,o1;if(!j||(!m1&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){n1=this._aBasicAreaSelection[i];if(j===n1.filterItem){return n1.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){o1=this._mAdvancedAreaFilter[n];if(o1&&o1.items){for(i=0;i<o1.items.length;i++){n1=o1.items[i];if((m1||!n1.filterItem._isParameter())&&(j===n1.filterItem)){return n1.control;}}}}}}return null;};d1.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};d1.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};d1.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};d1.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this._determineFilterItemByName(n);if(j){var m1=j.getGroupName();if(m1!==d1.INTERNAL_GROUP){return m1;}}return null;};d1.prototype._determineItemByName=function(n,j){var i;var m1,n1;var o1=j;if(!n){return null;}if(!o1){o1=d1.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){n1=this._mAdvancedAreaFilter[o1];if(n1&&n1.items){for(i=0;i<n1.items.length;i++){m1=n1.items[i];if(m1&&m1.filterItem&&(m1.filterItem.getName()===n)){return m1;}}}}return null;};d1.prototype.determineFilterItemByName=function(n){var i=this._determineEnsuredItemByName(n);if(i&&i.filterItem){return i.filterItem;}return null;};d1.prototype._determineFilterItemByName=function(i){var n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){j=this._determineItemByName(i,n);if(j){return j.filterItem;}}}return null;};d1.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var m1=this._mAdvancedAreaFilter[n];if(m1&&m1.items){for(i=0;i<m1.items.length;i++){if(m1.items[i]&&m1.items[i].control===j){return m1.items[i];}}}}}}return null;};d1.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){j.formcontainer.destroy();delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}if(j.items[i]&&j.items[i].selectedAsPoCV){delete j.items[i].selectedAsPoCV;}}}}}}};d1.prototype.onAfterRendering=function(i){if(!(this._isPhone()||this._isTablet())){if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}};d1.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};d1.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};d1.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};d1.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};d1.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};d1.prototype._isFilterItemInBasicGroup=function(i){return i&&!i.getGroupName()||i.getGroupName()===d1.INTERNAL_GROUP;};d1.prototype.exit=function(){this._unregisterVariantManagement();this._destroyFilterControls();if(this._oHintText&&(this._oAdvancedPanel.indexOfContent(this._oHintText)<0)){this._oHintText.destroy();}window.sessionStorage.removeItem(this.getId());window.sessionStorage.removeItem("semanticDates");G.prototype.exit.apply(this,arguments);if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;}if(this._oAdaptFiltersDialogModel){this._oAdaptFiltersDialogModel=null;}if(this._oGroupPanel){this._oGroupPanel=null;}if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}if(this._oFilterDialogForm){this._oFilterDialogForm.destroy();this._oFilterDialogForm=null;}if(this.oModel){this.oModel.destroy();this.oModel=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;this._oInitializedDeferred=null;};var l1=function(){var i=this;this.promise=new Promise(function(j,n){i.resolve=j;i.reject=n;});};return d1;});
